# Chapter 13: Configuring Logging 

There sre 3 approaches to writing logs:
- systemd-journald: drfault for logging 
- direct write: some services write logs directly to lig files
- rsyslog

`systemd-journald` provides advanced log management. Collects messages from the kernel, boot processes and services and writes these messages to an event journal.

`journalctl` enables you to access a deep level of detail about messages that are logged. Integrated part of Systemd and receives messages generated by Shstemd units. 

**rsyslogd** is a logging service that has more features than journald, such as centralized logging and filtering messages based on modules. Writes log info to soecific files taht will be persistent between reboots. 

Admins use 3 approached to knoe more about what's happening on the machine:
1. `journalctl`: command to get detailed info from the journal

2. `systemctl status <unit> -l` gets the status of services and the most recent log entries which are significant

3. **rsyslogd**: monitor the files I. */var/log* which are written by rsyslogd. 

#### System log files

*/var/log/messages* contains generic lig file where most msgs are written to. Most commonly used log file. 

*/var/log/dmseg* contains kernel message logs. 

*/var/log/secure* contains authentication-related msgs. Shows whxih auth errors have ovcured on a server. 

*/var/log/boot.log* contains msgs relating to system start up. (Check this on the machine) 

*/var/log/audit/audit.log* contains audit messages. SELinux writes to this file. 

*/var/log/maillog* contains mail related messages 

*/var/log/httpd/* contains log foles written by Apache web server. Apache writes directly to this file, not through rsyslog. 

To read the contents of a log file, you can use the `less` pager utility. 

`tail -f <logfile>` view real time log messages that are added (in real time)

`logger` allows users to write messages from the command line or a script. Able to specify priority and facility here. 

`systemctl-journald` stores log msgs in the journal. The journal is a binary file that is temporarily being stored in /run/log/journal.

Journal can be examined using `journalctl`. 

`journalctl` manages and views system logs collected by the systemd-journald service. 
- provides access to logs from the kernel, srrvices, applications and system
- loss can be filtered based on services, time range or priorities
- automatically uses `less` pager 

`journalctl -f` shows last/end of log msgs where new lines were added automatically. 

Search options **/** and **?** work in journalctl. Type **G** to go to the end of the msgs. 

`journalctl -o verbose` shows very detailed info that helps with debugging. 

journalctl time ranges:
- for a specific time period, use `--since` or/and `--until`
- time parameter format: **YYYY-MM-DD hh:mm:ss**
- can use *yesterday, today* and *tomorrow* as parameters 
- *Ex:* `journalctl --since yesterday`

`journalctl -n 20` shows the last 20 lines of the journal

journalctl options:
- **-f** shows the end of the journal and adds real time messages as they are generated. 
- **-b** shows boot log
- **-x** adds additional explanation to the messages shown which makes it easier to understand
- **-u** filter log msgs for a specific unit. *Ex:* `journalctl -u sshd`. 
- **-p** filters messages with a specific priority. *Ex:* `journalctl -p warn` displays all warning logs 

Journal is stored in **/run/log/journal**. 
The */run* directory is used for current process stats only, meaning the journal gets wiped when a system reboots. To make the journal persistent, store it in **/var/log/journal**.

**systemd-journald**
- the logging daemon that gathers and manages logs 
- runs as a background process
- can be managed with `systemctl`

**systemd-journal**
- utility for querying, viewing and interacting with logo
- provides tools like `journalctl` to access and analyze log data 

**rsyslog** allows you to manage where and how info should be written in with the */etc/rsyslog.conf* file

**rsyslog.conf file sections** 

- **facility**
    - a category of info that is logged which can't be extended or changed 
    - *Ex:* cron, kernel, user, etc. 
    - **local 0-7**: if services donâ€™t have their own rsyslog facility and need to log messages to a specific file, they can use this. 
        - this needs to be configured for the specific service. Need to add a rule in rsyslog.conf
- **priority**
    - defines the severity of the message that needs to be logged




